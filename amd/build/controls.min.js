define("theme_bambuco/controls",["exports","jquery","core/modal","core/modal_events","core/log"],(function(_exports,_jquery,_modal,_modal_events,_log){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * TODO describe module controls
   *
   * @module     theme_bambuco/controls
   * @copyright  2025 David Herney @ BambuCo
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_jquery=_interopRequireDefault(_jquery),_modal=_interopRequireDefault(_modal),_modal_events=_interopRequireDefault(_modal_events),_log=_interopRequireDefault(_log);_exports.init=async()=>{(0,_jquery.default)(".bbco-openinmodal").each((function(){var $this=(0,_jquery.default)(this);$this.parents('[data-fieldtype="editor"]')&&$this.parents('[data-fieldtype="editor"]').length>0||($this.find("a").each((function(){this.removeAttribute("onclick")})),$this.find("a").on("click",(function(event){event.preventDefault();var $link=(0,_jquery.default)(this),dialogue=$link.data("dialogue");if(dialogue)dialogue.show();else{var w=$this.attr("data-property-width"),h=$this.attr("data-property-height"),url=$link.attr("href")+"&inpopup=true",$iframe=(0,_jquery.default)('<iframe class="bbco-openinmodal-container"></iframe>');$iframe.attr("src",url),$iframe.on("load",(function(){$iframe.contents().find("a:not([target])").attr("target","_top")}));var el=_jquery.default.fn.hide;_jquery.default.fn.hide=function(){return this.trigger("hide"),el.apply(this,arguments)},(0,_jquery.default)("<div></div>").append($iframe);var properties={width:"95vw",height:"95vh"};if(w){if(w.indexOf("%")>=0){var windowW=(0,_jquery.default)(window).width(),tmpW=Number(w.replace("%",""));!isNaN(tmpW)&&tmpW>0&&(w=tmpW*windowW/100)}isNaN(w)||(w+="px"),properties.width=w}if(h){if(h.indexOf("%")>=0){var windowH=(0,_jquery.default)(window).height(),tmpH=Number(h.replace("%",""));!isNaN(tmpH)&&tmpH>0&&(h=tmpH*windowH/100)}isNaN(h)||(h+="px"),properties.height=h}_modal.default.create({body:$iframe,title:$link.attr("title")||$link.text()}).then((function(modal){return modal.getRoot().on(_modal_events.default.hidden,(function(){$iframe.contents().find("video, audio").each((function(){this.pause()}))})),modal.getRoot().find("> .modal-dialog").attr("style","width: "+properties.width+"; height: "+properties.height+";").addClass("bbco-modal-dialog"),modal.show(),$link.data("dialogue",modal),modal})).catch((function(e){_log.default.debug("Error creating modal"),_log.default.debug(e)}))}})))}))}}));

//# sourceMappingURL=controls.min.js.map